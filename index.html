<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrecificApp Inteligente</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #121214; --card: #1c1c1e; --orange: #ff6600;
            --white: #ffffff; --green: #22c55e; --red: #ef4444;
            --blue: #3b82f6; --gray: #3d3d3d;
        }

        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--white); margin: 0; padding: 20px; font-size: 14px; }
        .container { max-width: 1050px; margin: 0 auto; }
        
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--orange); padding-bottom: 15px; margin-bottom: 30px; }
        h3 { color: var(--orange); text-transform: uppercase; font-size: 0.85rem; letter-spacing: 1px; margin-bottom: 20px; }

        .layout { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        @media (max-width: 900px) { .layout { grid-template-columns: 1fr; } }

        .card { background: var(--card); padding: 25px; border-radius: 16px; border: 1px solid var(--gray); margin-bottom: 20px; }
        
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        label { display: block; font-size: 0.7rem; color: #aaa; margin-bottom: 6px; font-weight: 700; text-transform: uppercase; }
        
        input { width: 100%; background: #000; border: 1px solid var(--gray); padding: 12px; border-radius: 8px; color: #fff; outline: none; box-sizing: border-box; font-size: 1rem; }
        input:focus { border-color: var(--orange); }

        /* M√≥dulo de Sugest√£o */
        .suggestion-box { background: #252529; border: 1px dashed var(--orange); padding: 15px; border-radius: 12px; margin-bottom: 20px; }
        .btn-group { display: flex; gap: 10px; margin-top: 10px; }
        .btn-sug { flex: 1; background: #333; border: 1px solid var(--orange); color: var(--white); padding: 10px; border-radius: 8px; cursor: pointer; font-weight: 600; transition: 0.2s; }
        .btn-sug:hover { background: var(--orange); color: #000; }

        .result-main { background: #000; border: 2px solid var(--orange); border-radius: 20px; padding: 30px; text-align: center; }
        .big-price { font-size: 3.5rem; font-weight: 800; margin: 10px 0; letter-spacing: -2px; }

        .detail-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--gray); }
        .status-badge { font-size: 11px; padding: 4px 10px; border-radius: 20px; font-weight: bold; background: #333; }

        .comp-bar { display: flex; height: 12px; border-radius: 6px; overflow: hidden; margin: 20px 0; background: #333; }
        .comp-item { height: 100%; transition: width 0.4s ease; }

        .proj-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(130px, 1fr)); gap: 12px; margin-top: 25px; }
        .proj-card { background: var(--card); padding: 15px; border-radius: 12px; border: 1px solid var(--gray); text-align: center; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1 style="margin:0; font-size: 1.5rem; color: var(--orange);">PrecificApp <span style="color:white">Consultor</span></h1>
        <select id="moeda" style="background:#000; color:white; border:1px solid var(--orange); padding:8px; border-radius:8px;" onchange="calcular()">
            <option value="R$">BRL (R$)</option>
            <option value="$">USD ($)</option>
            <option value="‚Ç¨">EUR (‚Ç¨)</option>
            <option value="¬£">GBP (¬£)</option>
        </select>
    </div>

    <div class="layout">
        <div>
            <div class="card">
                <h3>1. Custos Fixos & Log√≠stica</h3>
                <div class="input-grid">
                    <div><label>Custo Produto</label><input type="number" id="custoProd" placeholder="0.00" oninput="calcular()"></div>
                    <div><label>Frete (Envio)</label><input type="number" id="frete" placeholder="0.00" oninput="calcular()"></div>
                </div>
                <div class="input-grid">
                    <div><label>Importa√ß√£o (%)</label><input type="number" id="impImp" placeholder="0" oninput="calcular()"></div>
                    <div><label>ICMS / IOF (%)</label><input type="number" id="icms" placeholder="0" oninput="calcular()"></div>
                </div>
            </div>

            <div class="card">
                <h3>2. Opera√ß√£o & Marketing</h3>
                <div class="input-grid">
                    <div><label>Checkout (%)</label><input type="number" id="taxaCheck" placeholder="0" oninput="calcular()"></div>
                    <div><label>Gateway (%)</label><input type="number" id="taxaGate" placeholder="0" oninput="calcular()"></div>
                </div>
                <div class="input-grid">
                    <div><label>Imposto Venda (%)</label><input type="number" id="impVenda" placeholder="0" oninput="calcular()"></div>
                    <div><label>Conting√™ncia (%)</label><input type="number" id="contingencia" placeholder="Ex: 2" oninput="calcular()"></div>
                </div>
                <label>CPA Marketing (%)</label>
                <input type="number" id="mktPerc" value="25" oninput="calcular()">
            </div>

            <div class="suggestion-box">
                <h3>üí° Sugest√£o Inteligente de Pre√ßo</h3>
                <p style="font-size: 0.75rem; color: #ccc;">Baseado nos seus custos acima, escolha uma margem alvo:</p>
                <div class="btn-group">
                    <button class="btn-sug" onclick="aplicarSugestao(0.2)">20% Lucro</button>
                    <button class="btn-sug" onclick="aplicarSugestao(0.3)">30% Lucro</button>
                    <button class="btn-sug" onclick="aplicarSugestao(0.4)">40% Lucro</button>
                </div>
            </div>
        </div>

        <div>
            <div class="result-main">
                <label style="color: var(--orange);">Pre√ßo de Venda Definido</label>
                <input type="number" id="precoVenda" style="text-align:center; font-size: 2.5rem; font-weight:800; background:transparent; border:none; margin: 10px 0;" placeholder="0.00" oninput="calcular()">
                <div id="resLucro" class="big-price">0,00</div>
                <div id="resMargem" style="font-weight: 700; letter-spacing: 1px;">Margem Final: 0%</div>
            </div>

            <div class="card" style="margin-top: 20px; padding: 15px;">
                <h3>An√°lise de Viabilidade</h3>
                <div class="detail-item"><span>Markup Real:</span> <span id="detMarkup">0x</span></div>
                <div class="detail-item"><span>Break-even CPA (Ponto Zero):</span> <span id="detBreakEven" style="color:var(--orange); font-weight:bold;">0</span></div>
                <div class="detail-item" style="border:0"><span>Lucro por Unidade:</span> <span id="detLucroUnit" style="color:var(--green); font-weight:bold;">0</span></div>
            </div>

            <div class="card">
                <h3>Composi√ß√£o Financeira</h3>
                <div class="comp-bar">
                    <div id="barCusto" class="comp-item" style="background: #444;"></div>
                    <div id="barMkt" class="comp-item" style="background: var(--orange);"></div>
                    <div id="barTaxas" class="comp-item" style="background: var(--blue);"></div>
                    <div id="barLucro" class="comp-item" style="background: var(--green);"></div>
                </div>
                <div class="detail-item"><span>(-) Produto + Log√≠stica:</span> <span id="detTotalBase">0</span></div>
                <div class="detail-item"><span>(-) CPA Marketing:</span> <span id="detMktReal">0</span></div>
                <div class="detail-item" style="border:0"><span>(-) Taxas + Impostos + Seguros:</span> <span id="detTaxasImp">0</span></div>
            </div>
        </div>
    </div>

    <h3>Proje√ß√£o de Escala de Lucro</h3>
    <div class="proj-grid" id="gridProj"></div>
</div>

<script>
    function aplicarSugestao(margemAlvo) {
        const v = (id) => parseFloat(document.getElementById(id).value) || 0;
        
        // Custos que n√£o dependem do pre√ßo de venda
        const custoLogistica = v('custoProd') + v('frete');
        const custoTotalOrigem = custoLogistica + (custoLogistica * ((v('impImp') + v('icms')) / 100));

        // Percentuais que dependem do pre√ßo de venda
        const percentuaisVariaveis = (v('taxaCheck') + v('taxaGate') + v('impVenda') + v('mktPerc') + v('contingencia')) / 100;

        // F√≥rmula: Pre√ßo = Custos Fixos / (1 - % Vari√°veis - % Margem Alvo)
        const divisor = 1 - percentuaisVariaveis - margemAlvo;

        if (divisor > 0) {
            const precoSugerido = custoTotalOrigem / divisor;
            document.getElementById('precoVenda').value = precoSugerido.toFixed(2);
            calcular();
        } else {
            alert("A soma dos impostos e taxas √© muito alta para essa margem!");
        }
    }

    function calcular() {
        const s = document.getElementById('moeda').value;
        const v = (id) => parseFloat(document.getElementById(id).value) || 0;

        const custoProd = v('custoProd'), frete = v('frete'), precoVenda = v('precoVenda');
        const impImp = v('impImp'), icms = v('icms'), mktPerc = v('mktPerc'), impVenda = v('impVenda');
        const taxaCheck = v('taxaCheck'), taxaGate = v('taxaGate'), contingencia = v('contingencia');

        // 1. Custo de Origem
        const custoTotalOrigem = (custoProd + frete) * (1 + (impImp + icms)/100);

        // 2. Custos Vari√°veis (Checkout + Gateway + Imposto Venda + Conting√™ncia + CPA)
        const percTotalVariavel = (taxaCheck + taxaGate + impVenda + contingencia + mktPerc) / 100;
        const vlrTotalVariavel = precoVenda * percTotalVariavel;

        // 3. Resultado Final
        const lucro = precoVenda - custoTotalOrigem - vlrTotalVariavel;
        const margem = precoVenda > 0 ? (lucro / precoVenda) * 100 : 0;
        const markup = custoTotalOrigem > 0 ? precoVenda / custoTotalOrigem : 0;
        const breakEvenCpa = precoVenda - custoTotalOrigem - (vlrTotalVariavel - (precoVenda * mktPerc/100));

        // Atualizar Dashboard
        const resL = document.getElementById('resLucro');
        resL.innerText = `${s} ${lucro.toFixed(2)}`;
        resL.style.color = lucro >= 0 ? 'var(--green)' : 'var(--red)';
        
        document.getElementById('resMargem').innerText = `Margem Final: ${margem.toFixed(1)}%`;
        document.getElementById('resMargem').style.color = margem >= 0 ? 'var(--green)' : 'var(--red)';

        document.getElementById('detMarkup').innerText = `${markup.toFixed(2)}x`;
        document.getElementById('detBreakEven').innerText = `${s} ${breakEvenCpa.toFixed(2)}`;
        document.getElementById('detLucroUnit').innerText = `${s} ${lucro.toFixed(2)}`;

        document.getElementById('detTotalBase').innerText = `${s} ${custoTotalOrigem.toFixed(2)}`;
        document.getElementById('detMktReal').innerText = `${s} ${(precoVenda * mktPerc/100).toFixed(2)}`;
        document.getElementById('detTaxasImp').innerText = `${s} ${(vlrTotalVariavel - (precoVenda * mktPerc/100)).toFixed(2)}`;

        // Barra Visual
        if(precoVenda > 0) {
            document.getElementById('barCusto').style.width = (custoTotalOrigem / precoVenda * 100) + "%";
            document.getElementById('barMkt').style.width = (mktPerc) + "%";
            document.getElementById('barTaxas').style.width = ((vlrTotalVariavel - (precoVenda * mktPerc/100)) / precoVenda * 100) + "%";
            document.getElementById('barLucro').style.width = (lucro > 0 ? (lucro / precoVenda * 100) : 0) + "%";
        }

        // Escala
        const escalas = [10, 50, 100, 500, 1000, 10000];
        document.getElementById('gridProj').innerHTML = escalas.map(q => `
            <div class="proj-card">
                <small>${q} VENDAS</small>
                <div style="color:${lucro >= 0 ? 'var(--green)' : 'var(--red)'}; font-weight:bold; margin-top:5px;">
                    ${s} ${(lucro * q).toLocaleString('pt-BR', {minimumFractionDigits: 2})}
                </div>
            </div>
        `).join('');
    }
</script>
</body>
</html>
